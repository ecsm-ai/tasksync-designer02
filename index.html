<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TaskSync Designer</title>
  <style>
    body { font-family: sans-serif; margin: 0; padding: 0; }
    header { background: #4a90e2; color: white; padding: 10px; display: flex; justify-content: space-between; align-items: center; }
    header button { margin-right: 5px; }
    .container { display: flex; height: calc(100vh - 50px); }
    .sidebar { width: 200px; border-right: 1px solid #ccc; padding: 10px; overflow-y: auto; }
    .main { flex: 1; padding: 10px; display: flex; flex-direction: column; }
    .gantt { flex: 1; border: 1px solid #ccc; margin-bottom: 10px; overflow-x: auto; }
    .details { border: 1px solid #ccc; padding: 10px; }
    .dark { background: #222; color: #ddd; }
    .dark header { background: #222; }
    .task-overdue { background: #f88; }
  </style>
</head>
<body>
<header>
  <div>
    <button onclick="filterTasks('all')">すべて</button>
    <button onclick="filterTasks('today')">今日</button>
    <button onclick="filterTasks('week')">今週</button>
    <button onclick="filterTasks('overdue')">期限切れ</button>
  </div>
  <div>
    <button onclick="toggleDarkMode()">🌙/☀️</button>
  </div>
</header>
<div class="container">
  <div class="sidebar" id="clientList"></div>
  <div class="main">
    <div class="gantt" id="ganttChart">ガントチャートエリア</div>
    <div class="details">
      <h3>タスク詳細</h3>
      <div id="taskDetails">タスクを選択してください</div>
      <input id="memoInput" placeholder="メモを追加"/>
      <button onclick="addMemo()">追加</button>
      <button onclick="generateInvoice()">請求書を作成</button>
    </div>
  </div>
</div>

<script>
let tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
let currentTaskId = null;

function filterTasks(mode){
  console.log("フィルタ:", mode);
}

function toggleDarkMode(){
  document.body.classList.toggle('dark');
}

function addMemo(){
  if(!currentTaskId) return;
  const txt = document.getElementById('memoInput').value;
  if(!txt) return;
  const task = tasks.find(t=>t.id===currentTaskId);
  task.memos = task.memos || [];
  task.memos.push({text: txt, date: new Date().toLocaleString()});
  localStorage.setItem('tasks', JSON.stringify(tasks));
  document.getElementById('memoInput').value = '';
  showTaskDetails(task);
}

function generateInvoice(){
  if(!currentTaskId) return;
  const task = tasks.find(t=>t.id===currentTaskId);
  const win = window.open();
  win.document.write(`<h1>請求書</h1><p>タスク: ${task.name}</p><p>金額: ¥100,000</p>`);
}

function showTaskDetails(task){
  currentTaskId = task.id;
  let html = `<p>名前: ${task.name}</p>`;
  if(task.memos){
    html += `<ul>` + task.memos.map(m=>`<li>${m.date}: ${m.text}</li>`).join('') + `</ul>`;
  }
  document.getElementById('taskDetails').innerHTML = html;
}

// デモ用のタスクを追加
if(tasks.length===0){
  tasks = [
    {id:1, name:'Webサイトデザイン', due:'2025-08-15'},
    {id:2, name:'ロゴ制作', due:'2025-08-20'}
  ];
  localStorage.setItem('tasks', JSON.stringify(tasks));
}
document.getElementById('clientList').innerHTML = '<p>クライアントA</p><p>クライアントB</p>';
</script>
</body>
</html>
